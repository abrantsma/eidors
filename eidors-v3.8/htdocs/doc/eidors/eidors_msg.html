<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of eidors_msg</title>
  <meta name="keywords" content="eidors_msg">
  <meta name="description" content="EIDORS_MSG eidors progress and status messages">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">eidors</a> &gt; eidors_msg.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for eidors&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>eidors_msg
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>EIDORS_MSG eidors progress and status messages</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function log_level= eidors_msg( message, varargin ) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment">EIDORS_MSG eidors progress and status messages

  EIDORS_MSG(STR, LVL) prints 'EIDORS:[ STR ]' if current log_level &lt;= LVL
     If the message starts with '@@@' then the characters are replaced 
     with the calling function's name. Default LVL = 2.

  EIDORS_MSG(STR, LVL, ...) uses STR as format string for fprintf passing
     to it any additional arguments. 

  LVL = EIDORS_MSG('log_level') returns the current log_level

  EIDORS_MSG('log_level', LVL) sets the log_level for all of EIDORS
  or EIDORS_MSG  log_level  LVL

  EIDORS_MSG('log_level', LVL, FNAME) sets a custom log_level for m-file
     FNAME (provide without extension)

  EIDORS_MSG('log_level','reset', FNAME) resets the log_level for m-file
     FNAME to the default level 

  EIDORS_MSG('log_level','reset')
  EIDORS_MSG('log_level','reset','all') resets all custom log-level
     settings to default

  Meanings of levels:
     0 =&gt; keep quiet (no messages should be level=0)
     1 =&gt; important messages
     2 =&gt; most messages
     3 =&gt; detailed information%

  Examples:
  eidors_msg('mission accomplished; time to relax', 1) prints 
     &gt;&gt; EIDORS:[ mission accomplished; time to relax ]'
       if log_level &lt;=1
  less important messages have higher levels

  eidors_msg('did %d of %s at %f', 2, 'stuff', sqrt(2), 1)
     &gt;&gt; EIDORS:[ did 2 of stuff at 1.414214 ]
 
  eidors_msg('@@');
     &gt;&gt; EIDORS:[eidors_msg]

  eidors_msg('@@@');
     &gt;&gt; EIDORS:[eidors_msg/do_unit_test]

  eidors_msg('@@@ a message',1);
     &gt;&gt; EIDORS:[eidors_msg/do_unit_test: a message]

  See also EIDORS_DEBUG, EIDORS_CACHE.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>	EIDORS_MSG eidors progress and status messages</li><li><a href="eidors_obj.html" class="code" title="function obj_id= eidors_obj(type,name, varargin );">eidors_obj</a>	EIDORS_OBJ: 'constructor' to create a eidors structure</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="../eidors/algorithms/eval_GREIT_fig_merit.html" class="code" title="function params = eval_GREIT_fig_merit(imgs, xyzr_pt)">eval_GREIT_fig_merit</a>	EVAL_GREIT_FIG_MERIT: calculate GREIT figures of merit for images</li><li><a href="../eidors/algorithms/left_divide.html" class="code" title="function [V] = left_divide(E,I,tol,pp,V)">left_divide</a>	[V] = left_divide(E,I,tol,pp,V);</li><li><a href="../eidors/deprecated/ab_tv_lagged_diff.html" class="code" title="function img=ab_tv_lagged_diff( inv_model, data1, data2)">ab_tv_lagged_diff</a>	AB_TV_LAGGED_DIFF Lagged Diffusivity Inverse Solver</li><li><a href="../eidors/deprecated/calc_noise_params.html" class="code" title="function params = calc_noise_params(imdl, vh, vi )">calc_noise_params</a>	params = GREIT_noise_params(imdl, homg_voltage, sig_voltage)</li><li><a href="../eidors/deprecated/edge_refined_elem_mapper.html" class="code" title="function [index_simp]=edge_refined_elem_mapper( mdl_coarse, mdl_dense)">edge_refined_elem_mapper</a>	EDGE_REFINED_ELEM_MAPPER: map elements from coarse to dense model</li><li><a href="../eidors/deprecated/edge_refined_node_mapper.html" class="code" title="function [index_vtx] = edge_refined_node_mapper(mdl_coarse, mdl_dense);">edge_refined_node_mapper</a>	EDGE_REFINED_NODE_MAPPER:</li><li><a href="../eidors/deprecated/forward_solver.html" class="code" title="function [V] = forward_solver(E,I,tol,pp,V, compat_param);">forward_solver</a>	[V] = forward_solver(E,I,tol,pp,V);</li><li><a href="../eidors/deprecated/image_levels.html" class="code" title="function image_levels(img, levels, clim )">image_levels</a>	IMAGE_LEVELS(img, levels, clim  ) show slices at levels of an image</li><li><a href="../eidors/deprecated/np_calc_image_prior.html" class="code" title="function Reg= np_calc_image_prior( inv_model );">np_calc_image_prior</a>	NP_CALC_IMAGE_PRIOR calculate image prior</li><li><a href="../eidors/deprecated/np_calc_system_mat.html" class="code" title="function s_mat= np_calc_system_mat( fwd_model, img)">np_calc_system_mat</a>	NP_CALC_SYSTEM_MAT: s_mat= np_calc_system_mat( fwd_model, img)</li><li><a href="../eidors/deprecated/np_fwd_parameters.html" class="code" title="function param = np_fwd_parameters( fwd_model )">np_fwd_parameters</a>	NP_FWD_PARAMETERS: data= np_fwd_solve( fwd_model )</li><li><a href="../eidors/deprecated/np_inv_solve.html" class="code" title="function img= np_inv_solve( inv_model, data1, data2)">np_inv_solve</a>	NP_INV_SOLVE inverse solver for Nick Polydorides EIDORS3D code</li><li><a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>	EIDORS_MSG eidors progress and status messages</li><li><a href="eidors_startup.html" class="code" title="function eidors_startup( path_array )">eidors_startup</a>	Script to start EIDORS</li><li><a href="../eidors/examples/demo_real.html" class="code" title="function [inhomg_img, demo_img] = demo_real;">demo_real</a>	[inhomg_img, demo_img] = demo_real;</li><li><a href="../eidors/examples/moving_tank_objs.html" class="code" title="function imgs= moving_tank_objs(data_sel, inv_sel, options)">moving_tank_objs</a>	MOVING_TANK_OBJS: create movies of objects moving in tanks</li><li><a href="../eidors/examples/resistor_model.html" class="code" title="function resistor_model;">resistor_model</a>	DEMO to show really simple application of EIDORS framework</li><li><a href="../eidors/graphics/matlab/calc_colours.html" class="code" title="function [colours,scl_data]= calc_colours(img, set_value, do_colourbar)">calc_colours</a>	[colours,scl_data]= calc_colours(img, set_value, do_colourbar)</li><li><a href="../eidors/graphics/matlab/calc_slices.html" class="code" title="function rimg = calc_slices( img, levels );">calc_slices</a>	calc_slices (img, levels, clim  ) show slices at levels of an</li><li><a href="../eidors/graphics/matlab/common_colourbar.html" class="code" title="function a = common_colourbar(ha,varargin)">common_colourbar</a>	COMMON_COLOURBAR make a joint colourbar for several subplots</li><li><a href="../eidors/graphics/matlab/crop_model.html" class="code" title="function [fmdl,c2f_idx]= crop_model( axis_handle, fcn_handle );">crop_model</a>	CROP_MODEL: Crop away parts of a fem model</li><li><a href="../eidors/graphics/matlab/print_convert.html" class="code" title="function print_convert(filename, varargin)">print_convert</a>	PRINT_CONVERT: print figures with anti-aliasing and trim them</li><li><a href="../eidors/graphics/matlab/show_fem.html" class="code" title="function hh=show_fem( mdl, options)">show_fem</a>	SHOW_FEM: show the EIDORS3D finite element model</li><li><a href="../eidors/graphics/matlab/show_fem_enhanced.html" class="code" title="function hh = show_fem(mdl, options)">show_fem_enhanced</a>	SHOW_FEM: show the EIDORS3D finite element model</li><li><a href="../eidors/graphics/matlab/show_slices.html" class="code" title="function out_img= show_slices( img, levels )">show_slices</a>	out_img = show_slices (img, levels ) show slices at levels of an</li><li><a href="../eidors/interface/eidors_readdata.html" class="code" title="function [vv, auxdata, stim ]= eidors_readdata( fname, format, frame_range, extra )">eidors_readdata</a>	EIDORS readdata - read data files from various EIT equipment</li><li><a href="../eidors/meshing/distmesh/dm_2d_circ_pt_elecs.html" class="code" title="function fmdl = dm_2d_circ_pt_elecs( elec_pts, pfix, spacing);">dm_2d_circ_pt_elecs</a>	DM_2D_CIRC_PT_ELECS: Create circle mesh (or radius 1) refined with electrodes</li><li><a href="../eidors/meshing/netgen/call_netgen.html" class="code" title="function status= call_netgen(geo_file, vol_file, msz_file, finelevel)">call_netgen</a>	CALL_NETGEN: call netgen to create a vol_file from a geo_file</li><li><a href="../eidors/meshing/netgen/fourier_fit.html" class="code" title="function C = fourier_fit(points,N,start);">fourier_fit</a>	FOURIER_FIT: use fourier series to interpolate onto a boundary</li><li><a href="../eidors/meshing/netgen/ng_mk_cyl_models.html" class="code" title="function [fmdl,mat_idx] = ng_mk_cyl_models(cyl_shape, elec_pos,elec_shape, extra_ng_code);">ng_mk_cyl_models</a>	NG_MAKE_CYL_MODELS: create cylindrical models using netgen</li><li><a href="../eidors/meshing/netgen/ng_mk_gen_models.html" class="code" title="function [fmdl,mat_idx] = ng_mk_gen_models(shape_str, elec_pos,  elec_shape, elec_obj, extra_ng_code);">ng_mk_gen_models</a>	NG_MK_GEN_MODELS: create generic models using netgen</li><li><a href="../eidors/meshing/netgen/ng_mk_geometric_models.html" class="code" title="function [fmdl, mat_idx] = ng_mk_geometric_models(body_geometry, electrode_geometry)">ng_mk_geometric_models</a>	NG_MK_GEOMETRIC_MODELS: create geometric mesh models using Netgen. Body</li><li><a href="../eidors/meshing/netgen/ng_read_mesh.html" class="code" title="function[srf,vtx,fc,bc,simp,edg,mat_ind] = ng_read_mesh(filename)">ng_read_mesh</a>	[srf,vtx,fc,bc,simp,edg,mat_ind] = ng_read_mesh(filename)</li><li><a href="../eidors/meshing/ng_mk_common_model.html" class="code" title="function fmdl = ng_mk_common_model(mdl_type,mdl_shape, elec_pos, elec_shape);">ng_mk_common_model</a>	NG_MK_COMMON_MODEL: utility to create common models</li><li><a href="../eidors/models/data_mapper.html" class="code" title="function img = data_mapper(img, reverse)">data_mapper</a>	DATA_MAPPER maps img.params data to elem or node data</li><li><a href="../eidors/models/find_edge2edge_intersections.html" class="code" title="function [pts,FE2CE,FE2pts,CE2pts] = find_edge2edge_intersections(FE,FN,CE,CN, epsilon)">find_edge2edge_intersections</a>	FIND_EDGE2EDGE_INTERSECTIONS intersections between edges of two models</li><li><a href="../eidors/models/fix_model.html" class="code" title="function [mdl] = fix_model(mdl,opt)">fix_model</a>	FIX_MODEL: Add useful fields to a model</li><li><a href="../eidors/models/mdl_normalize.html" class="code" title="function out = mdl_normalize(mdl, val)">mdl_normalize</a>	MDL_NORMALIZE Check or set the normalize_measurements flag on a model.</li><li><a href="../eidors/models/mk_GREIT_model.html" class="code" title="function [imdl, weight]= mk_GREIT_model( fmdl, radius, weight, options )">mk_GREIT_model</a>	MK_GREIT_MODEL: make EIDORS inverse models using the GREIT approach</li><li><a href="../eidors/models/mk_c2f_circ_mapping.html" class="code" title="function [mapping failed] = mk_c2f_circ_mapping( mdl, xyzr );">mk_c2f_circ_mapping</a>	MK_C2F_CIRC_MAPPING: create a mapping matrix from circles/spheres to FEM</li><li><a href="../eidors/models/mk_grid_c2f.html" class="code" title="function [c2f, m] = mk_grid_c2f(fmdl, rmdl, opt)">mk_grid_c2f</a>	MK_GRID_C2F - calculate a coarse2fine mapping for grid coarse models.</li><li><a href="../eidors/models/mk_library_model.html" class="code" title="function out = mk_library_model(shape,elec_pos,elec_shape,maxsz,nfft,scale)">mk_library_model</a>	MK_LIBRARY_MODEL - FEM models based on library shapes</li><li><a href="../eidors/models/mk_tet_c2f.html" class="code" title="function [c2f] = mk_tet_c2f(fmdl, rmdl, opt)">mk_tet_c2f</a>	MK_TET_C2F - calculate a coarse2fine mapping for two tet-based models.</li><li><a href="../eidors/models/mk_tri_c2f.html" class="code" title="function c2f = mk_tri_c2f(fmdl,rmdl,opt)">mk_tri_c2f</a>	MK_TRI_C2F</li><li><a href="../eidors/models/place_elec_on_surf.html" class="code" title="function mdl2 = place_elec_on_surf(mdl,elec_pos, elec_spec,ng_opt_file, maxh)">place_elec_on_surf</a>	PLACE_ELEC_ON_SURF Place electrodes on the surface of a model</li><li><a href="../eidors/models/select_imdl.html" class="code" title="function inv_mdl= select_imdl( mdl, options )">select_imdl</a>	SELECT_IMDL: select pre-packaged inverse model features</li><li><a href="../eidors/models/shape_library.html" class="code" title="function out = shape_library(action, shape, varargin)">shape_library</a>	SHAPE_LIBRARY Common shapes for models</li><li><a href="../eidors/models/simulate_3d_movement.html" class="code" title="function [vh,vi,xyzr_pt]= simulate_3d_movement( n_sims, fmdl, rad_pr,movefcn )">simulate_3d_movement</a>	SIMULATE_3D_MOVEMENT simulate rotational movement in 3D</li><li><a href="../eidors/solvers/calc_JiRtRJt.html" class="code" title="function [JiRtRJt,iRtRJt] = calc_JiRtRJt( inv_model, varargin )">calc_JiRtRJt</a>	[JiRtRJt,iRtRJt] = calc_JiRtRJt( inv_model, varargin )</li><li><a href="../eidors/solvers/calc_RtR_prior.html" class="code" title="function RtR_prior = calc_RtR_prior( inv_model )">calc_RtR_prior</a>	RtR = calc_RtR_prior( inv_model )</li><li><a href="../eidors/solvers/forward/find_boundary.html" class="code" title="function [srf, idx] = find_boundary(simp);">find_boundary</a>	[srf, idx] = find_boundary(simp);</li><li><a href="../eidors/solvers/forward/jacobian_movement.html" class="code" title="function J = jacobian_movement(fwd_model, img)">jacobian_movement</a>	JACOBIAN_MOVEMENT   Computes the Jacobian matrix for conductivity and</li><li><a href="../eidors/solvers/inv_solve.html" class="code" title="function img = inv_solve( inv_model, data1, data2)">inv_solve</a>	INV_SOLVE: calculate imag from an inv_model and data</li><li><a href="../eidors/solvers/inverse/GREIT_desired_img_sigmoid.html" class="code" title="function PSF = GREIT_desired_img_sigmoid(xyz,radius, opt)">GREIT_desired_img_sigmoid</a>	GREIT_DESIRED_IMG_SIGMOID sigmoid-decay desired image function for GREIT</li><li><a href="../eidors/solvers/inverse/calc_TSVD_RM.html" class="code" title="function RM= calc_TSVD_RM(mdl,hp)">calc_TSVD_RM</a>	CALC_TSVD_RM: Calculated truncated Jacobian SVD reconstruction matrix</li><li><a href="../eidors/solvers/inverse/calc_noise_figure.html" class="code" title="function [NF,SE] = calc_noise_figure( inv_model, hp, iterations)">calc_noise_figure</a>	CALC_NOISE_FIGURE: calculate the noise amplification (NF) of an algorithm</li><li><a href="../eidors/solvers/inverse/calc_solution_error.html" class="code" title="function [e res] = calc_solution_error(imgc, imdl, vh, vi)">calc_solution_error</a>	CALC_SOLUTION_ERROR Calculate residuals for a solution</li><li><a href="../eidors/solvers/inverse/choose_noise_figure.html" class="code" title="function HP= choose_noise_figure( inv_model );">choose_noise_figure</a>	CHOOSE_NOISE_FIGURE: choose hyperparameter based on NF calculation</li><li><a href="../eidors/solvers/inverse/inv_solve_TV_irls.html" class="code" title="function img=inv_solve_TV_irls( inv_model, data1, data2)">inv_solve_TV_irls</a>	INV_SOLVE_TV_IRLS Iteratively Reweighted Least Squares inverse solver</li><li><a href="../eidors/solvers/inverse/inv_solve_backproj.html" class="code" title="function img= inv_solve_backproj( inv_model, data1, data2)">inv_solve_backproj</a>	INV_SOLVE_BACKPROJ inverse solver using backprojection</li><li><a href="../eidors/solvers/inverse/inv_solve_diff_GN_one_step.html" class="code" title="function img= inv_solve_diff_GN_one_step( inv_model, data1, data2)">inv_solve_diff_GN_one_step</a>	INV_SOLVE_DIFF_GN_ONE_STEP inverse solver using approach of Adler&Guardo 1996</li><li><a href="../eidors/solvers/inverse/inv_solve_diff_kalman.html" class="code" title="function img= inv_solve_diff_kalman( inv_model, data1, data2)">inv_solve_diff_kalman</a>	INV_SOLVE_DIFF_KALMAN inverse solver for difference EIT</li><li><a href="../eidors/solvers/inverse/primaldual_tvrecon_lsearch.html" class="code" title="function [rs,x]=primaldual_tvrecon_lsearch(inv_mdl, vmeas,maxiter,alpha1,alpha2, epsilon, beta, min_change)">primaldual_tvrecon_lsearch</a>	[rs,x]=primaldual_tvrecon_lsearch(inv_mdl, vmeas, ...</li><li><a href="../eidors/tests/calc_jacobian_test.html" class="code" title="function ok= calc_jacobian_test">calc_jacobian_test</a>	Verify Jacobian Calculation by small derivative from forward problem</li><li><a href="../eidors/tests/demo_real_test.html" class="code" title="function ok= demo_real_test">demo_real_test</a>	Perform tests based on the demo_real function</li><li><a href="../eidors/tests/demo_real_test2.html" class="code" title="function ok= demo_real_test2">demo_real_test2</a>	Perform tests based on the demo_real function with new structs</li><li><a href="../eidors/tests/demo_real_test3.html" class="code" title="function ok= demo_real_test3">demo_real_test3</a>	Perform tests based on the demo_real function with new structs</li><li><a href="../eidors/tests/tutorials_test.html" class="code" title="function [errors warnings] = tutorials_test(directory,tcount)">tutorials_test</a>	TUTORIAL_TEST: Run all tutorials</li><li><a href="../eidors/tools/eidors_cache.html" class="code" title="function varargout=eidors_cache( command, varargin )">eidors_cache</a>	EIDORS_CACHE Control eidors caching</li><li><a href="../eidors/tools/eidors_debug.html" class="code" title="function out = eidors_debug(command, fstr)">eidors_debug</a>	EIDORS_DEBUG Global managment of debug flags</li><li><a href="../eidors/tools/progress_msg.html" class="code" title="function progress_msg(varargin)">progress_msg</a>	PROGRESS_MSG Progress messages and timing.</li><li><a href="../eidors/tools/unit_test_cmp.html" class="code" title="function unit_test_cmp(txt,a,b,tol)">unit_test_cmp</a>	UNIT_TEST_CMP: compare matrices in eidors output</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function log_level = process_log_level(varargin)</a></li><li><a href="#_sub2" class="code">function [file fun] = get_caller</a></li><li><a href="#_sub3" class="code">function [log_level] = get_levels</a></li><li><a href="#_sub4" class="code">function do_unit_test</a></li><li><a href="#_sub5" class="code">function extra_caller</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function log_level= eidors_msg( message, varargin )</a>
0002 <span class="comment">%EIDORS_MSG eidors progress and status messages</span>
0003 <span class="comment">%</span>
0004 <span class="comment">%  EIDORS_MSG(STR, LVL) prints 'EIDORS:[ STR ]' if current log_level &lt;= LVL</span>
0005 <span class="comment">%     If the message starts with '@@@' then the characters are replaced</span>
0006 <span class="comment">%     with the calling function's name. Default LVL = 2.</span>
0007 <span class="comment">%</span>
0008 <span class="comment">%  EIDORS_MSG(STR, LVL, ...) uses STR as format string for fprintf passing</span>
0009 <span class="comment">%     to it any additional arguments.</span>
0010 <span class="comment">%</span>
0011 <span class="comment">%  LVL = EIDORS_MSG('log_level') returns the current log_level</span>
0012 <span class="comment">%</span>
0013 <span class="comment">%  EIDORS_MSG('log_level', LVL) sets the log_level for all of EIDORS</span>
0014 <span class="comment">%  or EIDORS_MSG  log_level  LVL</span>
0015 <span class="comment">%</span>
0016 <span class="comment">%  EIDORS_MSG('log_level', LVL, FNAME) sets a custom log_level for m-file</span>
0017 <span class="comment">%     FNAME (provide without extension)</span>
0018 <span class="comment">%</span>
0019 <span class="comment">%  EIDORS_MSG('log_level','reset', FNAME) resets the log_level for m-file</span>
0020 <span class="comment">%     FNAME to the default level</span>
0021 <span class="comment">%</span>
0022 <span class="comment">%  EIDORS_MSG('log_level','reset')</span>
0023 <span class="comment">%  EIDORS_MSG('log_level','reset','all') resets all custom log-level</span>
0024 <span class="comment">%     settings to default</span>
0025 <span class="comment">%</span>
0026 <span class="comment">%  Meanings of levels:</span>
0027 <span class="comment">%     0 =&gt; keep quiet (no messages should be level=0)</span>
0028 <span class="comment">%     1 =&gt; important messages</span>
0029 <span class="comment">%     2 =&gt; most messages</span>
0030 <span class="comment">%     3 =&gt; detailed information%</span>
0031 <span class="comment">%</span>
0032 <span class="comment">%  Examples:</span>
0033 <span class="comment">%  eidors_msg('mission accomplished; time to relax', 1) prints</span>
0034 <span class="comment">%     &gt;&gt; EIDORS:[ mission accomplished; time to relax ]'</span>
0035 <span class="comment">%       if log_level &lt;=1</span>
0036 <span class="comment">%  less important messages have higher levels</span>
0037 <span class="comment">%</span>
0038 <span class="comment">%  eidors_msg('did %d of %s at %f', 2, 'stuff', sqrt(2), 1)</span>
0039 <span class="comment">%     &gt;&gt; EIDORS:[ did 2 of stuff at 1.414214 ]</span>
0040 <span class="comment">%</span>
0041 <span class="comment">%  eidors_msg('@@');</span>
0042 <span class="comment">%     &gt;&gt; EIDORS:[eidors_msg]</span>
0043 <span class="comment">%</span>
0044 <span class="comment">%  eidors_msg('@@@');</span>
0045 <span class="comment">%     &gt;&gt; EIDORS:[eidors_msg/do_unit_test]</span>
0046 <span class="comment">%</span>
0047 <span class="comment">%  eidors_msg('@@@ a message',1);</span>
0048 <span class="comment">%     &gt;&gt; EIDORS:[eidors_msg/do_unit_test: a message]</span>
0049 <span class="comment">%</span>
0050 <span class="comment">%  See also EIDORS_DEBUG, EIDORS_CACHE.</span>
0051 
0052 <span class="comment">% (C) 2005-2014 Andy Adler and Bartlomiej Grychtol</span>
0053 <span class="comment">% License: GPL version 2 or version 3</span>
0054 <span class="comment">% $Id: eidors_msg.m 4837 2015-03-30 07:31:01Z aadler $</span>
0055 
0056 <span class="keyword">if</span> ischar(message) &amp;&amp; strcmp(message,<span class="string">'UNIT_TEST'</span>); <a href="#_sub4" class="code" title="subfunction do_unit_test">do_unit_test</a>; <span class="keyword">return</span>; <span class="keyword">end</span>
0057 
0058 <span class="keyword">if</span> ischar(message) &amp;&amp; strcmp(message, <span class="string">'log_level'</span>)
0059    log_level = <a href="#_sub1" class="code" title="subfunction log_level = process_log_level(varargin)">process_log_level</a>(varargin{:});
0060    <span class="keyword">return</span>;
0061 <span class="keyword">end</span>
0062 
0063 <span class="keyword">if</span> nargin==1
0064    args= {};
0065    level= 2;
0066 <span class="keyword">else</span>
0067    level= varargin{ nargin-1 };
0068    args= varargin( 1:nargin-2 );
0069 <span class="keyword">end</span>
0070 
0071 [log_level] = <a href="#_sub3" class="code" title="subfunction [log_level] = get_levels">get_levels</a>;
0072 
0073 <span class="keyword">for</span> i= 1:length(args)
0074    <span class="keyword">if</span> isa( args{i}, <span class="string">'function_handle'</span>)
0075       args{i} = func2str(args{i});
0076    <span class="keyword">end</span>
0077 <span class="keyword">end</span>
0078 
0079 <span class="comment">% It makes sense to print to stderr (fid=2), but matlab&gt;7 prints this in red</span>
0080 ver= <a href="eidors_obj.html" class="code" title="function obj_id= eidors_obj(type,name, varargin );">eidors_obj</a>(<span class="string">'interpreter_version'</span>);
0081 <span class="keyword">if</span> ver.ver&gt;=7; fid= 1;
0082 <span class="keyword">else</span> ;         fid= 2; <span class="keyword">end</span>
0083 
0084 
0085 <span class="comment">%try, lms= eidors_objects.last_message_size;</span>
0086 <span class="comment">%  if lms&gt;0; fprintf(fid,'%c', 8*ones(lms,1)); end</span>
0087 <span class="comment">%end</span>
0088 
0089 <span class="comment">% deal with variables</span>
0090 <span class="keyword">if</span> ~ischar(message)
0091    var = inputname(1);
0092    message = [var <span class="string">' = '</span> num2str(message)];
0093 <span class="keyword">end</span>
0094 
0095 
0096 <span class="comment">% Need to do twice to interpret text in message</span>
0097 <span class="comment">% message= sprintf(message, args{:} );</span>
0098 <span class="keyword">if</span> length(message)&gt;1 <span class="comment">% single characters are just for progress</span>
0099    <span class="keyword">if</span> length(message)&gt;=2 &amp;&amp; strcmp(message(1:2),<span class="string">'@@'</span>);
0100       <span class="keyword">if</span> length(message)==2; msg_extra = <span class="string">''</span>;
0101       <span class="keyword">else</span>                   msg_extra = [<span class="string">':'</span>, message(3:end)];
0102       <span class="keyword">end</span>
0103       [file fun] = <a href="#_sub2" class="code" title="subfunction [file fun] = get_caller">get_caller</a>();
0104       dbs = dbstack;
0105       <span class="keyword">if</span> length(message) &gt; 2 &amp;&amp; message(3) == <span class="string">'@'</span>
0106           <span class="keyword">if</span> length(message) == 3
0107               msg_extra = <span class="string">''</span>;
0108           <span class="keyword">else</span>
0109               msg_extra(2) = [];
0110           <span class="keyword">end</span>
0111           message = sprintf(<span class="string">'%s/%s%s'</span>, file, fun, msg_extra);
0112       <span class="keyword">else</span>
0113           message = sprintf(<span class="string">'%s%s'</span>, file , msg_extra);
0114       <span class="keyword">end</span>
0115    <span class="keyword">end</span>
0116    string= [sprintf(<span class="string">'%c'</span>,<span class="string">' '</span> * ones(1,level-1)), <span class="keyword">...</span>
0117             <span class="string">'EIDORS:['</span>,message,<span class="string">']\n'</span>];
0118        
0119 <span class="keyword">else</span>
0120    string= message;
0121 <span class="keyword">end</span>
0122 
0123 <span class="keyword">if</span> level &lt;= log_level
0124    fprintf(fid, string, args{:});
0125    <span class="keyword">if</span> exist(<span class="string">'OCTAVE_VERSION'</span>); fflush(fid); <span class="keyword">end</span>
0126    eidors_objects.last_message_size= 0;
0127 <span class="keyword">end</span>
0128 
0129 
0130 <a name="_sub1" href="#_subfunctions" class="code">function log_level = process_log_level(varargin)</a>
0131    <span class="keyword">global</span> eidors_objects
0132    <span class="keyword">if</span> isempty(varargin)
0133       <span class="comment">% eidors_msg('log_level');</span>
0134       log_level = eidors_objects.log_level;
0135       <span class="keyword">return</span>
0136    <span class="keyword">end</span>
0137    <span class="keyword">if</span> ischar(varargin{1}) &amp;&amp; ~isempty(str2num(varargin{1}))
0138       varargin{1} = str2num(varargin{1});
0139    <span class="keyword">end</span>
0140    <span class="keyword">if</span> isnumeric(varargin{1})
0141       log_level = eidors_objects.log_level;
0142       <span class="keyword">switch</span> nargin
0143          <span class="keyword">case</span> 1
0144             <span class="comment">% eidors_msg('log_level', 2);</span>
0145             eidors_objects.log_level = varargin{1};
0146          <span class="keyword">case</span> 2
0147             <span class="comment">% eidors_msg('log_level', 1, fname);</span>
0148             caller = <a href="#_sub2" class="code" title="subfunction [file fun] = get_caller">get_caller</a>;
0149             custom = eidors_objects.log_level_custom;
0150             <span class="keyword">if</span> isempty(custom), <span class="keyword">return</span>, <span class="keyword">end</span>
0151             idx = find(ismember(caller, custom.names), 1);
0152             <span class="keyword">if</span> isempty(idx), idx = length(custom.levels) + 1; <span class="keyword">end</span>
0153             eidors_objects.log_level_custom.names{idx} = caller;
0154             eidors_objects.log_level_custom.levels(idx) = varargin{1};
0155          <span class="keyword">otherwise</span>
0156             error(<span class="string">'Wrong number of inputs'</span>);
0157          
0158       <span class="keyword">end</span>
0159    <span class="keyword">elseif</span> ischar(varargin{1}) &amp;&amp; strcmp(varargin{1}, <span class="string">'reset'</span>)
0160       log_level = eidors_objects.log_level;
0161          
0162       <span class="keyword">switch</span> nargin
0163          <span class="keyword">case</span> 1
0164             <span class="comment">% eidors_msg('log_level','reset');</span>
0165             eidors_objects.log_level_custom.names = {};
0166             eidors_objects.log_level_custom.levels = []; 
0167          <span class="keyword">case</span> 2
0168             <span class="keyword">switch</span> varargin{2}
0169                <span class="keyword">case</span> <span class="string">'all'</span>
0170                   <span class="comment">% eidors_msg('log_level','reset', 'all');</span>
0171                   eidors_objects.log_level_custom.names = {};
0172                   eidors_objects.log_level_custom.levels = [];
0173                <span class="keyword">otherwise</span>
0174                   caller = <a href="#_sub2" class="code" title="subfunction [file fun] = get_caller">get_caller</a>;
0175                   idx = find(ismember(caller, <span class="keyword">...</span>
0176                               eidors_objects.log_level_custom.names{1}), 1);
0177                   eidors_objects.log_level_custom.names(idx) = [];
0178                   eidors_objects.log_level_custom.levels(idx) = [];
0179             <span class="keyword">end</span>
0180          <span class="keyword">otherwise</span>
0181             error(<span class="string">'Wrong number of inputs'</span>);
0182       <span class="keyword">end</span>
0183             
0184    <span class="keyword">else</span>
0185       error(<span class="string">'Wrong input, consult help.'</span>);
0186       
0187    <span class="keyword">end</span>
0188       
0189 
0190 <a name="_sub2" href="#_subfunctions" class="code">function [file fun] = get_caller</a>
0191    dbs = dbstack;
0192    file = dbs(3).file;
0193    idx = find(file == <span class="string">'.'</span>, 1, <span class="string">'last'</span>);
0194    <span class="keyword">if</span> isempty(idx), idx = length(file)+1; <span class="keyword">end</span>
0195    file = file(1:idx-1);
0196 
0197    fun =  dbs(3).name;
0198 
0199 <a name="_sub3" href="#_subfunctions" class="code">function [log_level] = get_levels</a>
0200    <span class="keyword">global</span> eidors_objects
0201    <span class="keyword">try</span> 
0202       custom = eidors_objects.log_level_custom;
0203    <span class="keyword">catch</span>
0204       custom.names = {};
0205       custom.levels = [];
0206       eidors_objects.log_level_custom = custom;
0207    <span class="keyword">end</span>
0208    <span class="keyword">if</span> ~isempty(custom)
0209       <span class="comment">% find caller file name</span>
0210       file = <a href="#_sub2" class="code" title="subfunction [file fun] = get_caller">get_caller</a>;
0211       <span class="comment">% check for custom flag</span>
0212       idx = find(ismember(file, custom.names));
0213       <span class="keyword">if</span> ~isempty(idx)
0214          log_level = custom.levels(idx);
0215          <span class="keyword">return</span>
0216       <span class="keyword">end</span>
0217    <span class="keyword">end</span>
0218    <span class="keyword">try</span>
0219       log_level= eidors_objects.log_level;
0220    <span class="keyword">catch</span>
0221       log_level= 2; <span class="comment">% default;</span>
0222       eidors_objects.log_level= log_level;
0223    <span class="keyword">end</span>
0224 
0225 <a name="_sub4" href="#_subfunctions" class="code">function do_unit_test</a>
0226    ll= <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'log_level'</span>);
0227    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'log_level'</span>,5);
0228    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'l1'</span>,1); <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'l2'</span>,2); <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'l3'</span>,3); <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'l4'</span>,4);
0229 
0230    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'log_level'</span>,1);
0231    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'l1'</span>,1); <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'l2'</span>,2); <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'l3'</span>,3); <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'l4'</span>,4);
0232 
0233    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'@@'</span>,1);
0234    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'@@@'</span>,1);
0235    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'@@ a message'</span>,1);
0236    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'@@@ a message'</span>,1);
0237    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'a @@ message'</span>,1);
0238    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'a @@@ message'</span>,1);
0239    <a href="#_sub5" class="code" title="subfunction extra_caller">extra_caller</a>;
0240 
0241    <span class="comment">% test custom levels</span>
0242    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'log_level'</span>,2);
0243    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'FAIL'</span>,3);
0244    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'log_level'</span>,1, <span class="string">'eidors_msg'</span>);
0245    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'PASS'</span>,1);
0246    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'FAIL'</span>,2);
0247    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'log_level'</span>,3, <span class="string">'eidors_msg'</span>);
0248    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'PASS'</span>,3);
0249    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'FAIL'</span>,4);
0250    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'log_level'</span>,<span class="string">'reset'</span>,<span class="string">'eidors_msg'</span>);
0251    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'PASS'</span>,2);
0252    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'FAIL'</span>,3);
0253    <span class="comment">% just for fun</span>
0254    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'log_level'</span>,<span class="string">'reset'</span>); 
0255    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'log_level'</span>,<span class="string">'reset'</span>,<span class="string">'all'</span>); 
0256    
0257    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'log_level'</span>,ll);
0258    
0259 
0260 <a name="_sub5" href="#_subfunctions" class="code">function extra_caller</a>
0261    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'@@@ a message from extra_caller'</span>,1);
0262    <a href="eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'@@ a shorter message from extra caller'</span>,1);
0263</pre></div>
<hr><address>Generated on Tue 12-May-2015 16:08:56 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>